# ToolInterface Migration Guide (v1.1.0)

Version 1.1.0 of `opgginc/laravel-mcp-server` introduced a breaking change to `OPGG\\LaravelMcpServer\\Services\\ToolService\\ToolInterface`. If you are upgrading from v1.0.x you **must** update every tool implementation to match the new interface contract.

## Summary of Interface Changes

The interface now requires a new method and renames several existing methods:

1. **New method**
   - `messageType(): ProcessMessageType`
     - Required to support the HTTP stream transport by indicating the process message type.
2. **Method renames**
   - `getName()` → `name()`
   - `getDescription()` → `description()`
   - `getInputSchema()` → `inputSchema()`
   - `getAnnotations()` → `annotations()`

## Automated Migration Command

Use the bundled Artisan command to migrate existing tools automatically:

```bash
php artisan mcp:migrate-tools {path?}
```

### What the Command Does

1. **Identifies old tool implementations** that still use the v1.0.x method signatures.
2. **Creates a backup** of each tool file (`YourTool.php.backup`) before modifying it. Files that already contain a backup are skipped to prevent accidental overwrites.
3. **Refactors the tool class** by renaming the affected methods, inserting `messageType()`, and ensuring the `ProcessMessageType` enum import exists. The generated `messageType()` method defaults to `ProcessMessageType::SSE`.

### Usage Tips

- Run the command immediately after upgrading the package:
  ```bash
  php artisan mcp:migrate-tools
  ```
- Supply a different directory when your tools are not stored in the default `app/MCP/Tools/` path:
  ```bash
  php artisan mcp:migrate-tools path/to/your/tools
  ```
- Review the diff after running the command—complex files may still require manual tweaks.

## Manual Migration Reference

The following snippets compare the old and new interface definitions and show how to update an implementation manually.

### v1.0.x `ToolInterface`

```php
<?php

namespace OPGG\LaravelMcpServer\Services\ToolService;

interface ToolInterface
{
    public function getName(): string;
    public function getDescription(): string;
    public function getInputSchema(): array;
    public function getAnnotations(): array;
    public function execute(array $arguments): mixed;
}
```

### v1.1.0 `ToolInterface`

```php
<?php

namespace OPGG\LaravelMcpServer\Services\ToolService;

use OPGG\LaravelMcpServer\Enums\ProcessMessageType;

interface ToolInterface
{
    public function messageType(): ProcessMessageType;
    public function name(): string;
    public function description(): string;
    public function inputSchema(): array;
    public function annotations(): array;
    public function execute(array $arguments): mixed;
}
```

### Example Implementation After Migration

```php
use OPGG\LaravelMcpServer\Services\ToolService\ToolInterface;
use OPGG\LaravelMcpServer\Enums\ProcessMessageType;

class MyTool implements ToolInterface
{
    /**
     * @deprecated since v1.3.0, use isStreaming() instead. Will be removed in v2.0.0
     */
    public function messageType(): ProcessMessageType
    {
        return ProcessMessageType::HTTP;
    }

    public function isStreaming(): bool
    {
        return false;
    }

    public function name(): string { return 'MyTool'; }
    public function description(): string { return 'This is my tool.'; }
    public function inputSchema(): array { return []; }
    public function annotations(): array { return []; }
    public function execute(array $arguments): mixed { /* ... */ }
}
```

With these changes your tools comply with the updated interface and remain compatible with future releases.
